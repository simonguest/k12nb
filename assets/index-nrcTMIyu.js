import{r as B,f as m,M as f,N as i,O as d,m as l,P as w,Q as h,u as c,K as v,R as _,H as I,F as N,b as R,w as E,S as A,U as L,V as M,W as j}from"./@vue-CuCZ4c_x.js";import{V as z,a as S,b as T,c as k,d as W,e as x,f as b,g as F,h as U,i as C,j as O,k as P,l as H,m as q,n as D}from"./vuetify-Dj2xGtXH.js";import{v as K}from"./uuid-C6aID195.js";import{m as J}from"./marked-DK8KC6kv.js";import{z as y,E as G,A as Q}from"./@codemirror-C6laWxD4.js";import{b as X}from"./codemirror-DTUGriku.js";import"./@lezer-BrmOjncj.js";import"./crelt-C8TCjufn.js";import"./@marijn-DXwl3gUT.js";import"./style-mod-Bc2inJdb.js";import"./w3c-keyname-Vcq4gwWv.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();const p=B({content:{},findCell(o){return this.content.cells?this.content.cells.find(e=>e.id===o):null},getSource(o){const e=this.findCell(o);return e?e.source:null},setSource(o,e){const t=this.findCell(o);t&&(e=e.map(n=>n+`
`),t.source=e)},clearOutputs(o){const e=this.findCell(o);e&&(e.outputs=[])},getOutputTypes(o){var n,r,s;let e=[];const t=this.findCell(o);return t&&(((n=t.outputs)==null?void 0:n.findIndex(a=>a.output_type==="execute_result"))!==-1&&e.push("result"),((r=t.outputs)==null?void 0:r.findIndex(a=>a.output_type==="stream"&&a.name==="stdout"))!==-1&&e.push("stdout"),((s=t.outputs)==null?void 0:s.findIndex(a=>a.output_type==="error"))!==-1&&e.push("error")),e},addStdout(o,e){const t=this.findCell(o);if(t){t.outputs||(t.outputs=[]);const n=t.outputs.findIndex(r=>r.output_type==="stream"&&r.name==="stdout");n!==-1?(t.outputs[n].text||(t.outputs[n].text=[]),t.outputs[n].text.push(e)):t.outputs.push({output_type:"stream",name:"stdout",text:[e]})}},getStdout(o){var n;let e="";const t=this.findCell(o);return t&&((n=t.outputs)==null||n.forEach(r=>{var s;r.output_type==="stream"&&(e+=((s=r.text)==null?void 0:s.join(""))||"")})),e},setResult(o,e){const t=this.findCell(o);if(t){t.outputs||(t.outputs=[]);const n=t.outputs.findIndex(r=>r.output_type==="execute_result");if(n!==-1){const r=t.outputs[n].data||{};t.outputs[n].data={...r,...e}}else t.outputs.push({output_type:"execute_result",data:e})}},getResult(o){var n;let e={};const t=this.findCell(o);return t&&((n=t.outputs)==null||n.forEach(r=>{r.output_type==="execute_result"&&r.data&&(e=r.data)})),e},setError(o,e){const t=this.findCell(o);if(t){t.outputs||(t.outputs=[]);const n=Array.isArray(e)?e:e.split(`
`);t.outputs.push({output_type:"error",traceback:n})}},getError(o){var n;let e="";const t=this.findCell(o);return t&&((n=t.outputs)==null||n.forEach(r=>{var s;r.output_type==="error"&&(e+=((s=r.traceback)==null?void 0:s.join(""))||"")})),e},loadNotebook(o){o.cells&&(o.cells.forEach(e=>{(!e.id||typeof e.id!="string"||e.id.trim()==="")&&(e.id=K())}),this.content=o)}}),Y=["innerHTML"],Z=m({__name:"MarkdownCell",props:{source:{}},setup(o){const e=t=>t?J.parse(t.join("")):"";return(t,n)=>(i(),f(z,{variant:"text","max-width":"800",class:"pt-2 pb-2 ma-auto"},{default:d(()=>[l(S,null,{default:d(()=>[w("div",{innerHTML:e(t.source)},null,8,Y)]),_:1})]),_:1}))}}),u=B({executionStatus:"idle",workerStatus:"initializing",runningCellId:null,interruptBuffer:null,fatalErrorTrace:"",setInterruptBuffer(o){this.interruptBuffer=o},clearInterruptBuffer(){this.interruptBuffer&&(this.interruptBuffer[0]=0)},interruptExecution(){this.interruptBuffer&&(this.interruptBuffer[0]=2),this.executionStatus="idle"},setWorkerStatus(o){this.workerStatus=o},executeCell(o){this.executionStatus==="idle"&&this.workerStatus==="ready"&&(this.runningCellId=o,this.executionStatus="queued")},executionCompleted(){this.runningCellId=null,this.executionStatus="idle"},setFatalError(o){this.workerStatus="error",this.fatalErrorTrace=o}}),ee=m({__name:"CodeControls",props:{id:{}},setup(o){const e=o,t=()=>{p.clearOutputs(e.id),u.executeCell(e.id)},n=()=>{p.clearOutputs(e.id)},r=()=>{u.interruptExecution()};return(s,a)=>(i(),h("div",null,[w("div",null,[l(T,{rounded:"lg"},{default:d(()=>[l(k,{size:"32",icon:"mdi-play-outline",onClick:t,disabled:c(u).executionStatus!=="idle"||c(u).workerStatus!=="ready",loading:c(u).workerStatus!=="ready","aria-label":"Run code"},null,8,["disabled","loading"]),l(k,{size:"32",icon:"mdi-stop",onClick:r,disabled:c(u).executionStatus==="idle"||c(u).runningCellId!==s.id,"aria-label":"Stop code"},null,8,["disabled"])]),_:1}),l(T,{rounded:"lg",class:"pl-4"},{default:d(()=>[l(k,{size:"32",icon:"mdi-broom",onClick:n})]),_:1})])]))}}),te=y.theme({"&":{fontSize:"10.5pt",border:"0px",borderRadius:"5px",background:"#ffffff"},".cm-content":{fontFamily:"JetBrainsMono, monospace",minHeight:"100px"},".cm-gutters":{minHeight:"100px"},".cm-scroller":{overflow:"auto",maxHeight:"600px"}}),re=["id"],oe=m({__name:"CodeEditor",props:{source:{},id:{}},setup(o){const e=o;return v(()=>{var n;const t=G.create({doc:(n=e.source)==null?void 0:n.join(""),extensions:[X,Q(),te,y.lineWrapping,y.updateListener.of(r=>{if(r.docChanged){const s=r.state.doc.toString();p.setSource(e.id,s.includes(`
`)?s.split(`
`):[s])}})]});new y({state:t,parent:document.getElementById("code-editor-"+e.id)})}),(t,n)=>(i(),h("div",{id:`code-editor-${e.id}`},null,8,re))}}),ne={key:0,class:"output-console",readonly:""},se=m({__name:"Console",props:{stdout:{}},setup(o){return(e,t)=>e.stdout?(i(),h("textarea",ne,I(e.stdout),1)):_("",!0)}}),$=(o,e)=>{const t=o.__vccOpts||o;for(const[n,r]of e)t[n]=r;return t},ue=$(se,[["__scopeId","data-v-d2c2f4ad"]]),le={class:"output-console",readonly:""},ie=m({__name:"Error",props:{stderr:{}},setup(o){return(e,t)=>(i(),h("textarea",le,I(e.stderr),1))}}),ae=$(ie,[["__scopeId","data-v-21ca1749"]]),de={class:"output-console",readonly:""},ce=m({__name:"TextPlain",props:{value:{}},setup(o){return(e,t)=>(i(),h("textarea",de,I(Array.isArray(e.value)?e.value.join(""):e.value),1))}}),pe=$(ce,[["__scopeId","data-v-cb10ff75"]]),fe=["src"],me=m({__name:"ImagePng",props:{value:{}},setup(o){return(e,t)=>(i(),h("img",{src:`data:image/png;base64,${e.value}`},null,8,fe))}}),_e=["src"],he=m({__name:"ImageSvg",props:{value:{}},setup(o){return(e,t)=>(i(),h("img",{src:`data:image/svg+xml;charset=utf-8,${encodeURIComponent(e.value)}`},null,8,_e))}}),ge=m({__name:"Result",props:{value:{}},setup(o){return(e,t)=>(i(),h(N,null,[e.value["image/svg+xml"]?(i(),f(he,{key:0,value:e.value["image/svg+xml"]},null,8,["value"])):_("",!0),e.value["image/png"]?(i(),f(me,{key:1,value:e.value["image/png"]},null,8,["value"])):_("",!0),e.value["text/plain"]?(i(),f(pe,{key:2,value:e.value["text/plain"]},null,8,["value"])):_("",!0)],64))}}),ye=m({__name:"CodeCell",props:{cell:{}},setup(o){const e=o;let t=[];t=p.getOutputTypes(e.cell.id);const n=()=>{if(t.indexOf("result")!==-1)return"result";if(t.indexOf("stdout")!==-1)return"stdout";if(t.indexOf("error")!==-1)return"error"},r=R("result");return E(()=>e.cell.outputs,()=>{t=p.getOutputTypes(e.cell.id),r.value="none",r.value=n()||r.value},{deep:!0}),(s,a)=>(i(),f(z,{"max-width":"800",variant:"elevated",elevation:"2",color:"surface-light",class:"mb-2 pt-2 pb-2 ma-auto rounded-lg"},{default:d(()=>[l(S,null,{default:d(()=>[l(oe,{source:s.cell.source,id:s.cell.id},null,8,["source","id"])]),_:1}),l(F,{class:"pl-4 pr-4 d-flex justify-space-between"},{default:d(()=>[l(ee,{id:s.cell.id},null,8,["id"]),l(W,{modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=g=>r.value=g),class:"ml-auto"},{default:d(()=>[c(t).indexOf("result")!==-1?(i(),f(x,{key:0,value:"result",icon:"",size:"32",rounded:"lg","min-width":"48"},{default:d(()=>[l(b,{icon:"mdi-monitor"})]),_:1})):_("",!0),c(t).indexOf("stdout")!==-1?(i(),f(x,{key:1,value:"stdout",icon:"",size:"32","min-width":"48",rounded:"lg"},{default:d(()=>[l(b,{icon:"mdi-console"})]),_:1})):_("",!0),c(t).indexOf("error")!==-1?(i(),f(x,{key:2,value:"error",icon:"",size:"32","min-width":"48",rounded:"lg"},{default:d(()=>[l(b,{icon:"mdi-alert-circle-outline"})]),_:1})):_("",!0)]),_:1},8,["modelValue"])]),_:1}),l(S,null,{default:d(()=>[l(U,{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=g=>r.value=g),direction:"vertical"},{default:d(()=>[l(C,{value:"result"},{default:d(()=>[l(ge,{value:c(p).getResult(s.cell.id)},null,8,["value"])]),_:1}),l(C,{value:"stdout",direction:"vertical"},{default:d(()=>[l(ue,{stdout:c(p).getStdout(s.cell.id)},null,8,["stdout"])]),_:1}),l(C,{value:"error",direction:"vertical"},{default:d(()=>[l(ae,{stderr:c(p).getError(s.cell.id)},null,8,["stderr"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}}),ve=m({__name:"PyodideProvider",props:{notebookId:{}},setup(o){const e=o;let t;return v(async()=>{console.log("PyodideProvider: Starting new worker for "+e.notebookId),t=new Worker(new URL(""+new URL("PyodideWorker-CcsMhKFv.js",import.meta.url).href,import.meta.url),{type:"module"}),t.postMessage({type:"initialize"}),t.onmessage=async n=>{const{type:r,text:s,result:a,error:g,interruptBuffer:V}=n.data;switch(r){case"initialized":console.log("PyodideProvider: Pyodide is initialized"),u.setWorkerStatus("ready"),V&&(u.setInterruptBuffer(new Int32Array(V)),console.log("PyodideProvider: Set Interrupt Buffer"));break;case"stdout":u.runningCellId&&p.addStdout(u.runningCellId,s);break;case"execute_result":u.runningCellId&&a&&p.setResult(u.runningCellId,a);break;case"execute_completed":u.executionCompleted();break;case"error":u.runningCellId&&p.setError(u.runningCellId,g),u.executionCompleted();break;case"fatal":u.setFatalError(g);break}}}),A(async()=>{console.log("PyodideProvider: Terminating worker."),u.setWorkerStatus("terminating"),t.terminate()}),E(()=>u.executionStatus,n=>{if(n==="queued"&&u.runningCellId!=null){const r=p.getSource(u.runningCellId);t.postMessage({type:"run",cellId:u.runningCellId,code:r==null?void 0:r.join("")})}}),(n,r)=>L(n.$slots,"default")}}),ke={class:"renderer-container"},xe=m({__name:"Renderer",props:{id:{},initialNotebook:{}},setup(o){const e=o;return v(()=>{p.loadNotebook(e.initialNotebook)}),E(()=>e.initialNotebook,t=>{p.loadNotebook(t)}),(t,n)=>(i(),f(ve,{notebookId:t.id},{default:d(()=>[w("div",ke,[l(O,null,{default:d(()=>[c(u).workerStatus=="initializing"?(i(),f(P,{key:0,text:"The notebook is starting up...",type:"info",variant:"tonal",density:"compact"})):_("",!0)]),_:1}),l(O,null,{default:d(()=>[c(u).workerStatus=="error"?(i(),f(P,{key:0,text:`The notebook could not be started because of an error: ${c(u).fatalErrorTrace}`,type:"error",variant:"tonal",density:"compact"},null,8,["text"])):_("",!0)]),_:1}),(i(!0),h(N,null,M(c(p).content.cells,r=>(i(),h("div",null,[r.cell_type==="markdown"?(i(),f(c(Z),{key:0,source:r.source},null,8,["source"])):_("",!0),r.cell_type==="code"?(i(),f(c(ye),{key:1,cell:r},null,8,["cell"])):_("",!0)]))),256))])]),_:1},8,["notebookId"]))}}),be="test",Ce=m({__name:"App",setup(o){const e=R(null);return v(async()=>{try{const t=new URLSearchParams(window.location.search),n=t.has("sample")?t.get("sample"):"hello_world.ipynb",s=await(await fetch(`./samples/${n}`)).text();e.value=JSON.parse(s),console.log(`Notebook ${n} loaded`)}catch(t){console.error("Error loading notebook:",t)}}),(t,n)=>e.value?(i(),f(xe,{key:0,"initial-notebook":e.value,id:be},null,8,["initial-notebook"])):_("",!0)}}),Se=H({icons:{defaultSet:"mdi",aliases:D,sets:{mdi:q}},theme:{defaultTheme:"light"}});j(Ce).use(Se).mount("#app");
